# Word2Vec

{% embed url="https://zhuanlan.zhihu.com/p/29364112" %}

### word2vec 是word embedding 最好的工具吗？

| 优点 | 缺点 |
| :--- | :--- |
| 训练速度快（只有输入层和输出层） | 没有考虑语序，这里会有训练效果损失 |
| 易用，多种包中都有集成。 |  |
| 提速trick（Sigmoid，一次计算，词典Hash存储，层次Softmax） |  |

### word2vec 训练结果的差异主要来自什么因素？

### 2.1 语料影响最大

语料的场景，比如微博的语料和新闻语料训练的结果差别很大。因为微博属于个人发帖，比较随意。而新闻比较官方正式，另外新闻句式相对复杂。为什么会出现这种情况呢？因为 word2vec 的原理就是 一个词预测 前后词 或者 前后词 预测 当前词，使得概率最大化。

**2.1.1 相似的句子，相同部位的词 会相似。**

比如 句子1 w1 w2 w3 w4 X w5 w6 w7.

句子2 w1 w2 w3 w5 Y w5 w6 w7.

因为 X 的向量 受 w1 w2 w3 w4 w5 w6 w7 向量影响决定， Y也是受这几个词影响决定。

所以 X Y 是相似的。

**2.1.2 挨着近的词，也是相似的。**

比如 句子 w1 w2 w3 w4 X Y w5 w6 w7.  
这样 X Y 都是受到 来自 w1 w2 w3 w4 w5 w6 w7 向量影响决定。

所以X Y是相似的。

所以，微博和新闻的句子的整体分布是不一样的。 这里影响 结论 2.1.1.

其次，新闻长文多，句式复杂，微博短文多，这里影响结论2.1.2.

### 2.2 算法参数的影响。

算法参数对总体效果影响不大。相对来说，比较重要的参数有以下：

**2.2.1 负采样\(negative sampling\)**

降采样越低，对高频词越不利，对低频词有利。可以这么理解，本来高频词 词被迭代50次，低频词迭代10次，如果采样频率降低一半，高频词失去了25次迭代，而低频词只失去了5次。一般设置成le-5。个人觉得，降采样有类似tf-idf的功能，降低高频词对上下文影响的权重。

**2.2. 2 语言模型**

skip-gram 和cbow,之前有对比，切词效果偏重各不相同。  
从效果来看，感觉cbow对词频低的词更有利。这是因为 cbow是基于周围词来预测某个词，虽然这个词词频低，但是他是基于 周围词训练的基础上，通过算法来得到这个词的向量。通过周围词的影响，周围词训练的充分，这个词就会收益。

**2.2. 3 窗口大小**

窗口大小影响 词 和前后多少个词的关系，和语料中语句长度有关，建议可以统计一下语料中，句子长度的分布，再来设置window大小。一般设置成8。

**2.2. 4 min-count**

最小词频训练阀值，这个根据训练语料大小设置，只有词频超过这个阀值的词才能被训练。

根据经验，如果切词效果不好，会切错一些词，比如 “在深圳”，毕竟切错的是少数情况，使得这种错词词频不高，可以通过设置相对大一点的 min-count 过滤掉切错的词。

**2.2. 5 向量维度**

如果词量大，训练得到的词向量还要做语义层面的叠加，比如 句子 的向量表示 用 词的向量叠加，为了有区分度，语义空间应该要设置大一些，所以维度要偏大。一般 情况下200维够用。

**2.2. 6 其他参数**

比如学习率 可以根据需要调。









